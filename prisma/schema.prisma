generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["driverAdapters"]
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model User {
  id         Int       @id @default(autoincrement())
  username   String    @unique
  password   String
  firstName  String
  middleName String?
  lastName   String
  curp       String    @unique
  email      String    @unique
  advisors   Advisor[]
  students   Student[]
}

model Student {
  id            Int      @id @default(autoincrement())
  idUser        Int
  controlNumber String   @unique
  projectId     Int?
  project       Project? @relation(fields: [projectId], references: [id])
  user          User     @relation(fields: [idUser], references: [id])
  courses       Course[] @relation("CourseToStudent")
}

model Advisor {
  id          Int          @id @default(autoincrement())
  idUser      Int          @unique
  rfc         String       @unique
  isIntern    String       @default("true")
  user        User         @relation(fields: [idUser], references: [id])
  companies   Company[]    @relation("AdvisorToCompany")
  departments Department[] @relation("AdvisorToDepartment")
  projects    Project[]    @relation("AdvisorToProject")
}

model Company {
  id       Int       @id @default(autoincrement())
  codename String    @unique
  name     String
  size     String
  projects Project[]
  advisors Advisor[] @relation("AdvisorToCompany")
}

model Course {
  id       Int       @id @default(autoincrement())
  codename String
  name     String    @unique
  students Student[] @relation("CourseToStudent")
}

model Project {
  id          Int       @id @default(autoincrement())
  keyname     String    @unique
  name        String
  description String
  funding     Decimal
  dateBegin   DateTime  @default(now())
  dateEnd     DateTime?
  companyId   Int
  isFinished  String    @default("true")
  company     Company   @relation(fields: [companyId], references: [id])
  students    Student[]
  advisor     Advisor[] @relation("AdvisorToProject")
  tools       Tools[]   @relation("ProjectToTools")
}

model Department {
  id       Int       @id @default(autoincrement())
  codename String    @unique
  name     String
  advisors Advisor[] @relation("AdvisorToDepartment")
}

model Tools {
  id       Int       @id @default(autoincrement())
  name     String    @unique
  projects Project[] @relation("ProjectToTools")
}
